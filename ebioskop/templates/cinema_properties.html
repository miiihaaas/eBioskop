{% extends "layout.html" %}
{% block content %}
<div class="container-fluid py-4">
    <div class="row mb-4">
        <div class="col">
            {% if route_name == 'cinemas.create_cinema_properties' %}
            <h1 class="mb-3">Registracija Svojstava Bioskopa</h1>
            {% elif route_name == 'cinemas.edit_cinema_properties' %}
            <h1 class="mb-3">Izmena Svojstava Bioskopa</h1>
            {% endif %}
        </div>
    </div>
{{ users }}
    {% if route_name == 'cinemas.edit_cinema_properties' %}
    <div class="row mb-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
                    <h3 class="m-0">Bioskopske sale</h3>
                    <a href="{{ url_for('cinemas.create_cinema_hall', cinema_properties_id=cinema_properties.id) }}" class="btn btn-light">
                        <i class="fas fa-plus me-2"></i>Dodaj novu bioskopsku salu
                    </a>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-striped table-hover align-middle">
                            <thead class="table-light">
                                <tr>
                                    <th>Naziv sale</th>
                                    <th>Kapacitet</th>
                                    <th>Godina izgradnje</th>
                                    <th>Dimenzije</th>
                                    <th>Zvučni sistem</th>
                                    <th>Akcije</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for hall in halls %}
                                <tr>
                                    <td>{{ hall.hall_name }}</td>
                                    <td>{{ hall.hall_capacity }}</td>
                                    <td>{{ hall.year_built }}</td>
                                    <td>{{ hall.dimensions }}</td>
                                    <td>{{ hall.sound_system }}</td>
                                    <td>
                                        <a href="{{ url_for('cinemas.edit_cinema_hall', hall_id=hall.id) }}" class="btn btn-outline-primary btn-sm">
                                            <i class="fas fa-edit me-1"></i>Izmeni
                                        </a>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row mb-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
                    <h3 class="m-0">Kontakti u bioskopu</h3>
                    <a href="{{ url_for('users.register_cinema_manager', cinema_properties_id=cinema_properties.id) }}" class="btn btn-light">
                        <i class="fas fa-user-plus me-2"></i>Dodaj novi kontakt
                    </a>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-striped table-hover align-middle">
                            <thead class="table-light">
                                <tr>
                                    <th>Slika</th>
                                    <th>Ime i Prezime</th>
                                    <th>Email</th>
                                    <th>Pozicija</th>
                                    <th>Telefon</th>
                                    <th>Akcije</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for contact in users %}
                                <tr>
                                    <td>
                                        {% if contact.photo %}
                                            <img src="{{ url_for('static', filename='img/users/' + contact.photo) }}" alt="{{ contact.user_name }} {{ contact.user_surname }}" class="rounded-circle" style="width: 50px; height: 50px; object-fit: cover;">
                                        {% else %}
                                            <img src="{{ url_for('static', filename='img/default_user.png') }}" alt="Default User" class="rounded-circle" style="width: 50px; height: 50px; object-fit: cover;">
                                        {% endif %}
                                    </td>
                                    <td>{{ contact.user_name }} {{ contact.user_surname }}</td>
                                    <td>{{ contact.user_mail }}</td>
                                    <td>{{ contact.position }}</td>
                                    <td>{{ contact.phone }}</td>
                                    <td>
                                        <a href="{{ url_for('users.edit_cinema_manager', user_id=contact.id) }}" class="btn btn-outline-primary btn-sm">
                                            <i class="fas fa-edit me-1"></i>Izmeni
                                        </a>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h3 class="m-0">Podaci o bioskopu</h3>
                </div>
                <div class="card-body">
                    <form method="POST" enctype="multipart/form-data">
                        {{ form.hidden_tag() }}
                        <div class="row g-3">
                            <div class="col-md-6">
                                {{ form.local_name.label(class="form-label") }}
                                {{ form.local_name(class="form-control", placeholder="Unesite lokalni naziv bioskopa") }}
                                {% for error in form.local_name.errors %}
                                    <div class="text-danger">{{ error }}</div>
                                {% endfor %}
                            </div>
                            <div class="col-md-6">
                                {{ form.location.label(class="form-label") }}
                                {{ form.location(class="form-select") }}
                                {% for error in form.location.errors %}
                                    <div class="text-danger">{{ error }}</div>
                                {% endfor %}
                            </div>
                            <div class="col-md-3">
                                {{ form.city_population.label(class="form-label") }}
                                {{ form.city_population(class="form-control", placeholder="Broj stanovnika u gradu") }}
                                {% for error in form.city_population.errors %}
                                    <div class="text-danger">{{ error }}</div>
                                {% endfor %}
                            </div>
                            <div class="col-md-3">
                                {{ form.surrounding_population.label(class="form-label") }}
                                {{ form.surrounding_population(class="form-control", placeholder="Broj stanovnika u okolini") }}
                                {% for error in form.surrounding_population.errors %}
                                    <div class="text-danger">{{ error }}</div>
                                {% endfor %}
                            </div>
                            <div class="col-md-6">
                                <div class="form-check">
                                    {{ form.has_e_ticket_system(class="form-check-input") }}
                                    {{ form.has_e_ticket_system.label(class="form-check-label") }}
                                </div>
                                {% for error in form.has_e_ticket_system.errors %}
                                    <div class="text-danger">{{ error }}</div>
                                {% endfor %}
                            </div>
                            <div class="col-md-6">
                                {{ form.e_ticket_system.label(class="form-label") }}
                                {{ form.e_ticket_system(class="form-control", placeholder="Naziv e-ticket sistema") }}
                                {% for error in form.e_ticket_system.errors %}
                                    <div class="text-danger">{{ error }}</div>
                                {% endfor %}
                            </div>
                            <div class="col-md-6">
                                {{ form.promotion_methods.label(class="form-label") }}
                                {{ form.promotion_methods(class="form-control", rows="3", placeholder="Opišite metode promocije") }}
                                {% for error in form.promotion_methods.errors %}
                                    <div class="text-danger">{{ error }}</div>
                                {% endfor %}
                            </div>
                            <div class="col-md-6">
                                {{ form.programming_methods.label(class="form-label") }}
                                {{ form.programming_methods(class="form-control", rows="3", placeholder="Opišite metode programiranja") }}
                                {% for error in form.programming_methods.errors %}
                                    <div class="text-danger">{{ error }}</div>
                                {% endfor %}
                            </div>
                            <div class="col-md-6">
                                <div class="form-check">
                                    {{ form.is_distributor(class="form-check-input") }}
                                    {{ form.is_distributor.label(class="form-check-label") }}
                                </div>
                                {% for error in form.is_distributor.errors %}
                                    <div class="text-danger">{{ error }}</div>
                                {% endfor %}
                            </div>
                            <div class="col-md-6">
                                {{ form.photo_1.label(class="form-label") }}
                                {{ form.photo_1(class="form-control", accept="image/*") }}
                                {% for error in form.photo_1.errors %}
                                    <div class="text-danger">{{ error }}</div>
                                {% endfor %}
                            </div>
                            <div class="col-md-6">
                                {{ form.photo_2.label(class="form-label") }}
                                {{ form.photo_2(class="form-control", accept="image/*") }}
                                {% for error in form.photo_2.errors %}
                                    <div class="text-danger">{{ error }}</div>
                                {% endfor %}
                            </div>
                        </div>
                        <div class="mt-4">
                            {{ form.submit(class="btn btn-primary") }}
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}